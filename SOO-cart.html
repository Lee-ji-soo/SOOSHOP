<!doctype html>
<html lang="en">

<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css"
    integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">

  <script src="https://code.jquery.com/jquery-3.4.1.min.js"
    integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
  <script src="https://kit.fontawesome.com/51b298796c.js" crossorigin="anonymous"></script>

  <title>Hello, world!</title>
</head>

<body>
  <!--navibar HTML-->
  <nav class="navbar navbar-expand-lg navbar-light bg-light"
    style="position:fixed; width:100%; z-index:3;top:0; opacity:0.8">
    <a class="navbar-brand" href="./SOO-index.html">SOOSHOP</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav"
      aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav">
        <li class="nav-item active">
          <a class="nav-link" href="./SOO-index.html">Home <span class="sr-only">(current)</span></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="./SOO-cart.html">Cart</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#">About</a>
        </li>
        <li>
          <a onclick="modal열기('로그인하세요')" class="nav-link" href="#" role="button">Log in</a>
        </li>
        <li>
          <a onclick="modal열기('가입하세요')" class="nav-link ">가입하기</a>
        </li>
      </ul>
    </div>
  </nav>

  <div class="text-center" style="margin:90px; margin-bottom:20px;">
    <h4>장바구니</h4>
  </div>

  <table class="table table-light">
    <tr>
      <th scope="col">#</th>
      <th scope="col">상품명</th>
      <th scope="col">가격</th>
      <th scope="col">수량</th>
      <th scope="col">사이즈</th>
    </tr>
  </table>

  <div>
    <h4 style="display:inline">합계 = </h4><span style="font-size:25px" id="sum"></span>
  </div>


  <!--LOCALSTORAGE에 저장할때 
새로운 class를 만들어서 저장하기-->
  <script>    function SampleData(id, name, price, quantity, size) {
      this.id = id;
      this.name = name;
      this.price = price;
      this.quantity = quantity;
      this.size = size;
      localStorage.setItem('product' + this.id, JSON.stringify(this));
    }
    var data = new SampleData(1, '스쿱 넥 탱크 탑', 305000, 2, 'Small');
    var data2 = new SampleData(2, '인트레치아토 우븐 클러치', 4304000, 1, 'Large');
    var data3 = new SampleData(3, '플리세 플리츠 재킷', 3625000, 1, 'Medium');
    var data4 = new SampleData(4, 'GG 플로라 숄더 백', 1380000, 1, 'Medium');
    var data5 = new SampleData(5, '바로크 패턴 목욕 가운', 719000, 1, 'Medium');
  </script>

  <!--상품꺼내서 출력하기-->
  <script>
    for (i = 0; i < 5; i++) {
      var savedPd = localStorage.getItem(`product${i + 1}`)
      var parsedPd = JSON.parse(savedPd);

      $('.table').append(`<tr>
    <th>${i + 1}</th>
    <td>${parsedPd.name}</td>
    <td class="price">${parsedPd.price}</td>
    <td>
      <i class="fas fa-minus fa-1x minus"></i>
<span class="qunatity">${parsedPd.quantity}</span> 
      <i class="fas fa-plus fa-1x plus"></i>
      </td>
    <td>${parsedPd.size}</td>
    </tr>`)
    }
    $('.plus').on('click', function (e) {
      var quantity = $(e.target).siblings('span').html();
      $(e.target).siblings('span').html(Number(quantity) + 1);
    })
    //parseInt(quantity);
  </script>

  <script>
    //합계구하기
    function sum() {
      price = $('.price');
      let sum = 0;
      for (i = 0; i < price.length; i++) {
        sum += Number(price[i].innerHTML);
      }
      var sumKor = sum.toLocaleString();
      $('#sum').html(`₩${sumKor}`);
    }
  </script>

  <script>

    //마이너스키
    function minus(e) {
      var jprice = dataArr[`${$(e.target).parent().siblings('#dataId').html()}` - 1].price;
      var amount = $(e.target).siblings('span').html();
      if (amount > 0) {
        //1씩줄어듬
        $(e.target).siblings('span').html(Number(amount) - 1)
        //갯수는 변경된 내용
        amount = $(e.target).siblings('span').html();
        //가격의 내용 수정
        $(e.target).parent().siblings('.price').html(jprice * amount);

      } else {
        amount = 0
      }
      sum();
    }

    //플러스키
    function plus(e) {
      var jprice = dataArr[`${$(e.target).parent().siblings('#dataId').html()
        }` - 1].price;
      var amount = $(e.target).siblings('span').html();
      if (amount < 10) {
        //1씩줄어듬
        $(e.target).siblings('span').html(Number(amount) + 1)
        amount = $(e.target).siblings('span').html();
        $(e.target).parent().siblings('.price').html(jprice * amount);

      } else {
        amount = 10
      }
      sum();
    }


    $('.minus').on('click', minus);
    $('.plus').on('click', plus);
    sum();

  </script>

  <script>
    function deleteEle(e) {
      var clicked = $(e.target).parent().parent();
      var clickedId = clicked.data('id');

      for (i = 0; i < localStorage.length; i++) {
        clicked.remove();
        localStorage.removeItem(`product${clickedId}`);
      }
    }
    $('.delete').on('click', deleteEle);

  </script>




  <!-- Optional JavaScript -->
  <!-- jQuery first, then Popper.js, then Bootstrap JS -->

  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
    integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
    crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"
    integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI"
    crossorigin="anonymous"></script>
</body>

</html>